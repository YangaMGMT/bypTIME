<% provide(:title, @event.title.capitalize) %>
<div class="container">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h1><%= @event.title %></h1>
    </div>
    <div class="panel-body">
      <div class="row">
        <div class="col-md-3 event_datetime">
          <h4><%= @event.start_time.strftime("%A, %b %d") %></h4>
          <h4><%= @event.start_time.strftime("%l:%M %P") %></h4>
          <hr>
          <h4><%= @event.location %></h4>
          <h4><%= @event.address %></h4>
        </div>
        <div class="col-md-6">
          <%= @event.description %>
        </div>
        <div class="col-md-3 event_actions">
          <% if member_signed_in? && current_member.rsvp?(@event) %>
              <div><%= link_to "Unattend", unattend_path(attendee_id: current_member.id, event_id: @event.id), class: 'btn btn-default', method: :put %></div>
          <% else %>
              <div><%= link_to "RSVP", create_attendee_path(event_id: @event.id), class: 'btn btn-default', method: :post %></div>
          <% end %>
          <% if member_signed_in? && current_member.admin? %>
              <div><%= link_to "Edit", edit_event_path(@event), class: 'btn btn-default' %></div>
              <div><%= link_to "Delete", event_path(@event), class: 'btn btn-default', method: :delete, data: {confirm: 'Are you sure?'} %></div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <% if !@event.attendees.empty? && member_signed_in? %>
      <div class="panel panel-warning">
        <div class="panel-heading">Attending</div>
        <table class="table table-hover table-responsive">
          <tr>
            <th>Name</th>
            <th>Phone</th>
            <% if member_signed_in? && current_member.admin? %>
                <th>Check In</th>
            <% end %>
          </tr>
          <% @event.attendees.each do |attendee| %>
              <tr>
                <td>
                  <%= attendee.name %>
                </td>
                <td>
                  <%= number_to_phone(attendee.phone, area_code: true) %>
                </td>
                <% if member_signed_in? && current_member.admin? %>
                    <td>
                      <label class="event_check_in">
                        <%= check_box_tag 'check_in', attendee.id , attendee.in_attendance?(@event), class: 'check_in', "data-event-id" => @event.id %>
                        <span></span>
                      </label>
                    </td>
                <% end %>
              </tr>
          <% end %>
        </table>
      </div>
  <% end %>
</div>